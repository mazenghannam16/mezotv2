<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MezoCima</title>
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            text-align: center;
            padding: 20px;
            background-color: #022020;
            color: #ffffff;
        }

        .search-container {
            background-color: #022020;
            padding: 20px;
            border-radius: 10px;
            display: inline-block;
        }

        .search-container input {
            padding: 12px;
            font-size: 18px;
            border: none;
            border-radius: 5px;
            width: 250px;
            outline: none;
            font-weight: bold;
        }

        .search-container button {
            padding: 12px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            background-color: #f1c40f;
            color: #310003;
            cursor: pointer;
            margin-left: 10px;
            font-weight: bold;
        }

        #result {
            margin-top: 20px;
        }

        img {
            max-width: 150px;
            margin-top: 10px;
        }

        .info-row {
            margin-top: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .info-row button {
            margin-left: 10px;
            background-color: #011C44;
            border: none;
            padding: 8px;
            border-radius: 5px;
            color: #310003;
        }

        textarea {
            width: 300px;
            height: 30px;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            background-color: #333;
            color: #fff;
            font-family: 'Cairo', sans-serif;
            font-weight: bold;
            resize: none;
        }

        .cast-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }

        .cast-item {
            text-align: center;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    <h1>ابحث عن فيلم أو مسلسل</h1>
    <div class="search-container">
        <input type="text" id="searchTerm" placeholder="ابحث عن فيلم أو مسلسل بالاسم أو ID">
        <button onclick="searchMovieByName()">بحث بالاسم</button>
        <button onclick="searchMovieById()">بحث بالـ ID</button>
    </div>

    <div id="result"></div>

<script>
    const apiKey = '4b1125dc507cd0f303b025b30d6311dd';

    async function searchMovieByName() {
        const searchTerm = document.getElementById('searchTerm').value;
        if (!searchTerm) {
            alert('الرجاء إدخال اسم الفيلم أو المسلسل');
            return;
        }

        const url = `https://api.themoviedb.org/3/search/multi?api_key=${apiKey}&query=${searchTerm}&language=ar`;

        try {
            const response = await fetch(url);
            const data = await response.json();

            if (data.results.length > 0) {
                displayResult(data.results[0]);
            } else {
                document.getElementById('result').innerHTML = '<p>لم يتم العثور على نتائج.</p>';
            }
        } catch (error) {
            console.error(error);
            document.getElementById('result').innerHTML = '<p>حدث خطأ أثناء البحث. الرجاء المحاولة مرة أخرى.</p>';
        }
    }

    async function searchMovieById() {
        const searchTerm = document.getElementById('searchTerm').value;
        if (!searchTerm) {
            alert('الرجاء إدخال الـ ID');
            return;
        }

        const url = `https://api.themoviedb.org/3/movie/${searchTerm}?api_key=${apiKey}&language=ar`;

        try {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error('لم يتم العثور على فيلم أو مسلسل بهذا الـ ID');
            }

            const data = await response.json();
            displayResult(data);
        } catch (error) {
            console.error(error);
            document.getElementById('result').innerHTML = `<p>${error.message}</p>`;
        }
    }

    async function fetchCast(movieId) {
        const url = `https://api.themoviedb.org/3/movie/${movieId}/credits?api_key=${apiKey}&language=ar`;

        try {
            const response = await fetch(url);
            const data = await response.json();
            return data.cast.slice(0, 10); // عرض أول 10 ممثلين فقط
        } catch (error) {
            console.error(error);
            return [];
        }
    }

    async function displayResult(result) {
        const title = result.title || result.name;
        const description = result.overview || "لا يوجد وصف متاح";
        const releaseDate = result.release_date || result.first_air_date || "غير متاح";
        const imagePath = result.poster_path;
        const imageUrl = `https://image.tmdb.org/t/p/original${imagePath}`;

        let castHTML = '';
        if (result.id) {
            const cast = await fetchCast(result.id);
            castHTML = cast.map(member => 
                `<div class="cast-item">
                    <img src="https://image.tmdb.org/t/p/w200${member.profile_path}" alt="${member.name}">
                    <textarea id="castName-${member.id}" readonly>${member.name}</textarea>
                    <button onclick="copyText('castName-${member.id}')">نسخ اسم الممثل</button>
                    <textarea id="castImage-${member.id}" readonly>https://image.tmdb.org/t/p/w200${member.profile_path}</textarea>
                    <button onclick="copyText('castImage-${member.id}')">نسخ صورة الممثل</button>
                </div>`
            ).join('');
        }

        document.getElementById('result').innerHTML = `
            <h2>${title}</h2>
            <textarea id="movieTitle" readonly>${title}</textarea>
            <button onclick="copyText('movieTitle')">نسخ اسم الفيلم</button>
            <img src="${imageUrl}" alt="${title}">
            <textarea id="movieImage" readonly>${imageUrl}</textarea>
            <button onclick="copyText('movieImage')">نسخ صورة الفيلم</button>

            <div class="info-row">
                <strong>الوصف:</strong>
                <textarea id="description" readonly>${description}</textarea>
                <button onclick="copyText('description')">نسخ الوصف</button>
            </div>

            <div class="info-row">
                <strong>تاريخ الإصدار:</strong>
                <textarea id="releaseDate" readonly>${releaseDate}</textarea>
                <button onclick="copyText('releaseDate')">نسخ تاريخ الإصدار</button>
            </div>

            <div class="cast-list">
                ${castHTML || '<p>لا يوجد بيانات لفريق العمل</p>'}
            </div>
        `;
    }

    function copyText(id) {
        const textArea = document.getElementById(id);
        if (textArea) {
            textArea.select();
            document.execCommand("copy");
            alert("تم نسخ النص إلى الحافظة!");
        } else {
            const text = id;
            navigator.clipboard.writeText(text).then(() => {
                alert("تم نسخ النص إلى الحافظة!");
            });
        }
    }
</script>
</body>
</html>
